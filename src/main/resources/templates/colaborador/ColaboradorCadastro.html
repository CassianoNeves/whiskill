<!DOCTYPE html>
<html>
<head>
	{{> header}}
	<title>Cadastrar Colaborador</title>
	<style type="text/css">
		.row{
			margin-top: 20px;
		}
		.padding{
			padding: 10px;
			display: inline-block;
		}
		.alert-danger {
		  	color: rgb(51, 51, 51);
		  	background-color: #F8F8F8;
		  	border-color: #E7E7E7;
		}
		.checkbox{
			width: 20px !important;
		}
	</style>
</head>
<body>
	<div class="container">
		{{> navbar}}
		<!-- <form action="/colaborador/inserir" method="POST"> -->
			<div class="row">
				<div class="col-xs-4 col-md-4 col-lg-4">
				</div>

				<div class="col-xs-4 col-md-4 col-lg-4">
					<div class="row text-center">
						<h2>Cadastrar Colaborador</h2>
					</div>
					
					<div class="row text-center">
						<label>Nome:</label>
						<input type="text" name="nome" class="form-control" required />
					</div>
				</div>

				<div class="col-xs-4 col-md-4 col-lg-4">
				</div>
			</div>

			<div class="row text-center">
				<h2>Quais s√£o os Conhecimentos?</h2>
			</div>

			{{#trilhas}}
				<div id="{{idTrilha}}"class="row text-center alert alert-danger">
					<h2>{{nome}}</h2>
				</div>
			{{/trilhas}}

			<div class="row text-center">
				<input type="submit" value="Cadastrar" class="btn btn-primary"/>
			</div>
		<!-- </form> -->
	</div>
	{{> scripts}}
	<script>
		$(function(){
			{{#skills}}
			$('#{{trilha.idTrilha}}').append( 
				'<div class="padding thumbnail text-center">'+
					'<label>{{nome}}</label>'+
					'<input idSkill="{{idSkill}}" class="checkbox skills" type="checkbox" name="idSkills"/>'+
				'</div> ' );
			{{/skills}}

			$('[type="submit"]').click(function(i){
				$.ajax({
		  			url: '/colaborador/inserir/colaborador?nome='+$('input[name="nome"]').val(),
		  			type: 'POST',
		  			contentType: 'json',
				}).done(function(idColaborador){
					console.log(idColaborador);
					var query = '';
					$('input.skills:checked').each(function(i){
						query = query + 'INSERT INTO SKILLCOLABORADOR (IDSKILL, IDCOLABORADOR) VALUES ('+ $(this).attr("idSkill") +', '+ idColaborador +'); ';
					});

					$.ajax({
			  			url: '/colaborador/inserir/SkillColaborador?query=' + query,
			  			type: 'POST',
			  			contentType: 'json',
					}).done(function(res){
						//console.log('feito');
						window.location = '/colaborador/listar';
					});
				});
			});
		});
	</script>
</body>
</html>